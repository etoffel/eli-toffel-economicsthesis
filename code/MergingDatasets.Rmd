source('housekeeping')

# Load necessary libraries
library(dplyr)
library(fuzzyjoin)
library(readr)

# Load in Datasets

Cleaned_Harris_Poll_Scraped_Data_2019_2024 <- read_csv("data/Cleaned Data/Cleaned Harris Poll Data.csv")
View(Cleaned_Harris_Poll_Scraped_Data_2019_2024)

Fortune_500_Info_Data <- read_csv("data/Raw Data/Fortune 500 Info Data.csv")
View(Fortune_500_Info_Data)

# Rename the first column to "Company"
colnames(Fortune_500_Info_Data)[1] <- "Company"

# Check the updated column names
colnames(Fortune_500_Info_Data)

# Inspect column names to identify the company name columns
colnames(Cleaned_Harris_Poll_Scraped_Data_2019_2024)
colnames(Fortune_500_Info_Data)

# Assuming company names are stored under "Company" in both datasets
# Adjust the column names if they are different
fuzzy_matched_df <- stringdist_join(
  Cleaned_Harris_Poll_Scraped_Data_2019_2024, 
  Fortune_500_Info_Data, 
  by = "Company",  # Adjust column name as needed
  mode = "left",   # Keep all rows from Cleaned_Harris_Poll_Scraped_Data_2019_2024
  method = "jw",   # Jaro-Winkler similarity
  max_dist = 0.15  # Adjust distance threshold (lower = stricter)
)

# View results
View(fuzzy_matched_df)

